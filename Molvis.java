import javax.swing.UIManager;import javax.script.ScriptEngineManager;import javax.script.ScriptEngine;import javax.script.ScriptException;import java.awt.*;import java.io.*;import java.util.List;import java.awt.event.*;import javax.swing.*;import javax.swing.event.*;import org.jmol.adapter.smarter.SmarterJmolAdapter;import org.jmol.api.JmolViewer;import org.jmol.util.Logger;import org.openscience.jmol.app.jmolpanel.*;import java.util.*;import javax.swing.table.*;import java.util.regex.*; // Create a subclass of Frameclass MyWindowAdapter extends WindowAdapter {	String filename;JMenuFrame JMenuFrame;public MyWindowAdapter(JMenuFrame JMenuFrame) {this.JMenuFrame = JMenuFrame;}public void windowClosing(WindowEvent we) {JMenuFrame.setVisible(false);}}class JMenuFrame extends JFrame {static JTabbedPane tabbedPane;String msg = "";JCheckBoxMenuItem debug, test;JMenuFrame(String title) {super(title);// create menu bar and add it to frameJMenuBar mbar = new JMenuBar();UIManager.put("Menu.selectionBackground",new Color(245,29,29));UIManager.put("Menu.selectionForeground",Color.white);setJMenuBar(mbar);// create the menu itemsJMenu file = new JMenu("File");UIManager.put("Menu.selectionBackground",new Color(245,29,29));UIManager.put("Menu.selectionForeground",Color.white);JMenuItem item1, item2, item3, item4, item5;item1 = new JMenuItem("New...");UIManager.put("Menu.selectionBackground",new Color(245,29,29));UIManager.put("Menu.selectionForeground",Color.white);file.add(item1);item2 = new JMenuItem("LOAD CIF DATA");file.add(item2);item3 = new JMenuItem("Load MLC File");file.add(item3);item4 = new JMenuItem("Calculate HBond Characterization");file.add(item4);item5 = new JMenuItem("Quit...");file.add(item5);mbar.add(file);JMenu calculation = new JMenu("CIF Based Calculations");JMenuItem item20,item21;calculation.add(item20 = new JMenuItem("Energy Calculation"));calculation.add(item20);calculation.add(item21 = new JMenuItem("Density Calculations"));calculation.add(item21);mbar.add(calculation);JMenu edit = new JMenu("Edit");UIManager.put("Menu.selectionBackground",new Color(245,29,29));UIManager.put("Menu.selectifonForeground",Color.white);JMenuItem item6, item7, item8, item9;edit.add(item6 = new JMenuItem("Cut"));edit.add(item7 = new JMenuItem("Copy"));edit.add(item8 = new JMenuItem("Paste"));edit.add(item9 = new JMenuItem("-"));JMenu sub = new JMenu("Special");JMenuItem item10, item11, item12;sub.add(item10 = new JMenuItem("First"));sub.add(item11 = new JMenuItem("Second"));sub.add(item12 = new JMenuItem("Third"));edit.add(sub);// these are checkable menu itemsdebug = new JCheckBoxMenuItem("Debug");edit.add(debug);test = new JCheckBoxMenuItem("Testing");edit.add(test);mbar.add(edit);MyMenuHandler handler = new MyMenuHandler(this);// register it to receive those eventsitem1.addActionListener(handler);item2.addActionListener(handler);item3.addActionListener(handler);item4.addActionListener(handler);item5.addActionListener(handler);item6.addActionListener(handler);item7.addActionListener(handler);item8.addActionListener(handler);item9.addActionListener(handler);item10.addActionListener(handler);item11.addActionListener(handler);item12.addActionListener(handler);debug.addItemListener(handler);test.addItemListener(handler);item20.addActionListener(handler);// create an object to handle window eventsMyWindowAdapter adapter = new MyWindowAdapter(this);// register it to receive those eventsaddWindowListener(adapter);}}class MyMenuHandler  extends JPanel implements ActionListener, ItemListener {static String  strScript;static JmolViewer viewer;JMenuFrame JMenuFrame;static String fileName,mfileName,fnn;Object data[][],atomno[];static int clickcount=0;Moleculetab m1,m3;Moleculetab1 m2;FileWriter filewriter;//ArrayList atomno;public MyMenuHandler() {}public MyMenuHandler(JMenuFrame JMenuFrame) {this.JMenuFrame = JMenuFrame;}// Handle action eventspublic void actionPerformed(ActionEvent ae) {String msg = "You selected ";String arg = (String)ae.getActionCommand();if(arg.equals("LOAD CIF DATA")){Molvis.tabbedPane.setVisible(false);Molvis.downtabbedPane.setVisible(false);fnn=fileread();}else if(arg.equals("Load MLC File")){Molvis.tabbedPane.setVisible(true);Molvis.downtabbedPane.setVisible(true);mlcfileread();	}else if(arg.equals("Calculate HBond Characterization")){Molvis.tabbedPane.setVisible(true);Molvis.downtabbedPane.setVisible(true);hfileread(fnn);	}else if(arg.equals("PIXEL GUI")){	System.out.println("aa");	Molvis.tabbedPane.setVisible(true);Molvis.downtabbedPane.setVisible(true);pixel(fnn);	//	System.out.println("hai");	}else if(arg.equals("Quit..."))msg += "Quit.";else if(arg.equals("Edit"))msg += "Edit.";else if(arg.equals("Cut"))msg += "Cut.";else if(arg.equals("Copy"))msg += "Copy.";else if(arg.equals("Paste"))msg += "Paste.";else if(arg.equals("First"))msg += "First.";else if(arg.equals("Second"))msg += "Second.";else if(arg.equals("Third"))msg += "Third.";else if(arg.equals("Debug"))msg += "Debug.";else if(arg.equals("Testing"))msg += "Testing.";JMenuFrame.msg = msg;//JMenuFrame.repaint();}// Handle item eventspublic void itemStateChanged(ItemEvent ie) {//System.out.println(Molvis.tabbedPane.getSelectedIndex());}public void densityread(String fileName){	System.out.println(fileName);	//JFileChooser chooser = new JFileChooser(); 	//fileName=chooser.getSelectedFile().getName();	Density c1=new Density();c1.densityread(fileName);}public void mlcfileread() {Molvis.tabbedPane.removeAll();Molvis.downtabbedPane.removeAll();JFileChooser chooser = new JFileChooser(); int returnVal = chooser.showOpenDialog( JMenuFrame );if( returnVal == JFileChooser.APPROVE_OPTION ){mfileName=chooser.getSelectedFile().getName();A a1=new A();a1.mlcread(mfileName);try{B b1=new B();double listfiles[]=b1.ciffileread("test.cif",fileName);		//int size=al.size();		int k=0;		 data=new Object[listfiles.length][3];		 //atomno=new Object[size];for( int i=0;i<listfiles.length;i++)		{	String test="testout"+(i+1)+".cif";		data[k][0]=Boolean.FALSE;		data[k][1]=(Object)test;	data[k][2]=(Object)listfiles[i];			k++;	}		Molvis jpl=new Molvis();    jpl.showmol(fileName);//	m1=new Moleculetab(data,null);m3=new Moleculetab(data,"uday");		Molvis.tabbedPane.addTab("CIF DATA VISUALIZE",m1);	//Molvis.tabbedPane.addTab("Homology Modelling",new Modeller());    //Molvis.tabbedPane.addTab("Calculation Tab",new Molp());		Molvis.tabbedPane.setVisible(true);		Molvis.downtabbedPane.setVisible(true);Molvis.downtabbedPane.add("HBond Characterization ",m3);	//Molvis.downtabbedPane.add("Content ",new downPane());    //Molvis.downtabbedPane.add("Modes of operation ",new downPane());/* write code  here to clear the molvis objects */		 }catch(Exception e){	}}}public String fileread(){Molvis.tabbedPane.removeAll();Molvis.downtabbedPane.removeAll();JFileChooser chooser = new JFileChooser(); int returnVal = chooser.showOpenDialog( JMenuFrame );if( returnVal == JFileChooser.APPROVE_OPTION ){fileName=chooser.getSelectedFile().getName();String line="";ArrayList al=new ArrayList();try {   FileReader fileReader =new FileReader(fileName);    filewriter=new FileWriter("session.pdb");   BufferedReader bufferedReader =new BufferedReader(new FileReader(fileName),8*1024);   Pattern pattern = Pattern.compile("^[A-Z]");        while((line = bufferedReader.readLine()) != null) 	{	Matcher m = pattern.matcher(line);		if(m.find())	{		al.add(line);	}		}	    fileReader.close();   	filewriter.close();		}    catch(FileNotFoundException ex) 	{ System.out.println("Unable to open file '" + fileName + "'");                        }		catch(IOException ex)		{		System.out.println("Error in reading file"+fileName);		}						Iterator<String> it=al.listIterator();		String str="";		int size=al.size();		int k=0;		 data=new Object[size][3];		 atomno=new Object[size];		while(it.hasNext())		{		String str1=it.next();						Pattern ptn = Pattern.compile(" ");        String[] parts = ptn.split(str1);					data[k][0]=Boolean.FALSE;		data[k][1]=(Object)  "\t\t"+str1;		data[k][2]=(Object)parts[0];				k++;	}		Molvis jpl=new Molvis();    jpl.showmol(fileName);	m1=new Moleculetab(data);	m2=new Moleculetab1(data);	 	Molvis.tabbedPane.addTab("Molecule Tab",m1);		Molvis.tabbedPane.setVisible(true);		Molvis.downtabbedPane.setVisible(true);	/* write code  here to clear the molvis objects */		 }return fileName;//densityread(fileName);}//hfilereadpublic void hfileread(String fnn){Molvis.tabbedPane.removeAll();Molvis.downtabbedPane.removeAll();JFileChooser chooser = new JFileChooser(); int returnVal = chooser.showOpenDialog( JMenuFrame );if( returnVal == JFileChooser.APPROVE_OPTION ){//JOptionPane.showMessageDialog(null,JFileChooser.APPROVE_OPTION +" \t"+returnVal);//Runtime rt =Runtime.getRuntime();//rt.freeMemory();fileName=chooser.getSelectedFile().getName();//String pdbid=fileName.substring(0,4);//B b1=new B();//b1.ciffileread(fileName);String line="";//atomno=new ArrayList();ArrayList al=new ArrayList();try {   FileReader fileReader =new FileReader(fileName);    filewriter=new FileWriter("session.pdb");   BufferedReader bufferedReader =new BufferedReader(new FileReader(fileName),8*1024);   Pattern pattern = Pattern.compile("^[A-Z]");        while((line = bufferedReader.readLine()) != null) 	{	Matcher m = pattern.matcher(line);		if(m.find())	{		al.add(line);	}		}	    fileReader.close();   	filewriter.close();		}        catch(FileNotFoundException ex) { System.out.println("Unable to open file '" + fileName + "'");                        }		catch(IOException ex)		{		System.out.println("Error in reading file"+fileName);		}						Iterator<String> it=al.listIterator();		String str="";		int size=al.size();		int k=0;		 data=new Object[size][3];		 atomno=new Object[size];		while(it.hasNext())		{		String str1=it.next();						Pattern ptn = Pattern.compile(" ");        String[] parts = ptn.split(str1);					data[k][0]=Boolean.FALSE;		data[k][1]=(Object)  "\t\t"+str1;				data[k][2]=(Object)parts[0];				k++;	}		Molvis jpl=new Molvis();    jpl.showmol(fileName);	m1=new Moleculetab(data);	m2=new Moleculetab1(data);	  //JTextArea area=new JTextArea();  	//m2=new Moleculetab1(area);		Molvis.tabbedPane.addTab("Molecule Tab",m1);	//Molvis.tabbedPane.addTab("Homology Modelling",new Modeller());    //Molvis.tabbedPane.addTab("Calculation Tab",new Molp());		Molvis.tabbedPane.setVisible(true);		Molvis.downtabbedPane.setVisible(true);	 Molvis.downtabbedPane.add("HBond Characterization ",new downPane());//Molvis.downtabbedPane.add("Content ",m2);    /* write code  here to clear the molvis objects */		 }densityread(fileName);}/// pixel public void pixel(String fnn){Molvis.tabbedPane.removeAll();Molvis.downtabbedPane.removeAll();String onlyfilename=fnn.substring(0,1);String newcif=fnn;String line="";//atomno=new ArrayList();ArrayList al=new ArrayList();try {   FileReader fileReader =new FileReader(fileName);    filewriter=new FileWriter("session.pdb");   BufferedReader bufferedReader =new BufferedReader(new FileReader(fileName),8*1024);   Pattern pattern = Pattern.compile("^[A-Z]");        while((line = bufferedReader.readLine()) != null) 	{	Matcher m = pattern.matcher(line);		if(m.find())	{		al.add(line);	}		}	    fileReader.close();   	filewriter.close();		}        catch(FileNotFoundException ex) { System.out.println("Unable to open file '" + fileName + "'");                        }		catch(IOException ex)		{		System.out.println("Error in reading file"+fileName);		}						Iterator<String> it=al.listIterator();		String str="";		int size=al.size();		int k=0;		 data=new Object[size][3];		 atomno=new Object[size];		while(it.hasNext())		{		String str1=it.next();						Pattern ptn = Pattern.compile(" ");        String[] parts = ptn.split(str1);					data[k][0]=Boolean.FALSE;		data[k][1]=(Object)  "\t\t"+str1;				data[k][2]=(Object)parts[0];				k++;	}		Molvis jpl=new Molvis();    jpl.showmol(fileName);	m1=new Moleculetab(data);	m2=new Moleculetab1(data);	  //JTextArea area=new JTextArea();  	//m2=new Moleculetab1(area);		Molvis.tabbedPane.addTab("Molecule Tab",m1);	//Molvis.tabbedPane.addTab("Homology Modelling",new Modeller());    //Molvis.tabbedPane.addTab("Calculation Tab",new Molp());		Molvis.tabbedPane.setVisible(true);		Molvis.downtabbedPane.setVisible(true);	 Molvis.downtabbedPane.add("HBond Characterization ",new downPane());//Molvis.downtabbedPane.add("Content ",m2);    /* write code  here to clear the molvis objects */		 }//densityread(fileName);//uday}		// Create frame window.public class  Molvis{static JmolPanel jmolPanel;static JTabbedPane tabbedPane,downtabbedPane;//static  JTextArea pdbseq_display;public static void main(String ar[]) {JMenuFrame f = new JMenuFrame("MolVis");//f.setResizable(false);f.addWindowListener(new ApplicationCloser());f.setSize(1400, 740);Container contentPane = f.getContentPane();//object for jmol viewer here jmolPanel = new JmolPanel(); //jmolPanel.setPreferredSize(new Dimension(200, 200));JPanel panel = new JPanel(); //main panelpanel.setLayout(new GridLayout(1,2)); //main panelpanel.setBorder(BorderFactory.createTitledBorder("CIF Molecule Visualize"));panel.setBackground(Color.BLUE);JPanel first_panel = new JPanel(); //first panelfirst_panel.setLayout(new GridLayout(2,1)); //first paneltabbedPane = new JTabbedPane();downtabbedPane = new JTabbedPane();downtabbedPane.setBackground(Color.yellow);tabbedPane.setFont(new Font("serif", Font.PLAIN, 13));tabbedPane.setBackground(Color.yellow);String line = null;first_panel.add(tabbedPane);first_panel.add(downtabbedPane);panel.add(first_panel);panel.add(jmolPanel);contentPane.add(panel);f.setVisible(true);            	} //main method closes here 				void showmol(String fn){String strError="";//strError = jmolPanel.viewer.openFile("http://www.rcsb.org/pdb/download/downloadFile.do?fileFormat=pdb&compression=NO&structureId="+fn);jmolPanel.viewer.openFile(fn);String strScript = "set frank off; select all; hbonds off;select all; spin off; wireframe off; spacefill off; trace off; set ambient 40; set specpower 40; slab off; ribbons off; cartoons off; label off; monitor off; rotate x 25; rotate z -15; select all; spacefill .5	;background blue;";        if (strError == null)		{           //jmolPanel.viewer.evalString(strScript);           //jmolPanel.viewer.evalString("measure 3 4");        }		else            Logger.error(strError);} 		static class ApplicationCloser extends WindowAdapter {           public void windowClosing(WindowEvent e) 		{            System.exit(0);        }}// static class closes herestatic class JmolPanel extends JPanel {         JmolViewer viewer;        private final Dimension currentSize = new Dimension();        JmolPanel() 		{            viewer = JmolViewer.allocateViewer(this, new SmarterJmolAdapter(),null, null, null, null, null);        }        JmolPanel( int a) 		{            viewer = JmolViewer.allocateViewer(this, new SmarterJmolAdapter(),null, null, null, null, null);        }        public void paint(Graphics g) 		{		           getSize(currentSize);            viewer.renderScreenImage(g, currentSize.width, currentSize.height);			repaint();        }// inner class closes				    }//main method closes here}class Loopmodelling extends JPanel{Loopmodelling(){JPanel mainjp =new JPanel();mainjp.setLayout(new BorderLayout());JPanel jp =new JPanel();jp.setPreferredSize(new Dimension(650, 200));jp.setLayout(new GridLayout(4,2));JLabel target_label=new JLabel("\t\t\t\tEnter the target Sequence",JLabel.RIGHT);JTextArea target=new JTextArea("jjjjjjjjjj",100,150);JLabel temp_label=new JLabel("\t\t\t\tEnter the template ID(PDB code:1XYZ)",JLabel.RIGHT);JTextField template=new JTextField(10);JLabel chain_label=new JLabel("\t\t\t\tEnter the Chain identifier(A,B,C etc.)",JLabel.RIGHT);JTextField chain=new JTextField(10);JLabel cc=new JLabel("",JLabel.RIGHT);JButton jb=new JButton("Run Modeller");jp.add(target_label);jp.add(target);jp.add(temp_label);jp.add(template);jp.add(chain_label);jp.add(chain);jp.add(cc);jp.add(jb);mainjp.add(jp,BorderLayout.NORTH);add(mainjp);}}class Modeller extends JPanel {public Modeller(){JTabbedPane tabbedPane_modeller;tabbedPane_modeller = new JTabbedPane();tabbedPane_modeller.setPreferredSize(new Dimension(650, 650));tabbedPane_modeller.setFont(new Font("serif", Font.PLAIN, 11));tabbedPane_modeller.addTab("Help",new Modelerhelp());tabbedPane_modeller.addTab("GModeller",new GmodellerGui());tabbedPane_modeller.addTab("Loop Modelling ",new Loopmodelling());add(tabbedPane_modeller);}}class GmodellerGui extends JPanel{public GmodellerGui() {JPanel mainjp =new JPanel();mainjp.setLayout(new BorderLayout());JPanel jp =new JPanel();jp.setPreferredSize(new Dimension(650, 200));jp.setLayout(new GridLayout(4,2));JLabel target_label=new JLabel("\t\t\t\tEnter the target Sequence",JLabel.RIGHT);JTextArea target=new JTextArea("jjjjjjjjjj",100,150);JLabel temp_label=new JLabel("\t\t\t\tEnter the template ID(PDB code:1XYZ)",JLabel.RIGHT);JTextField template=new JTextField(10);JLabel chain_label=new JLabel("\t\t\t\tEnter the Chain identifier(A,B,C etc.)",JLabel.RIGHT);JTextField chain=new JTextField(10);JLabel cc=new JLabel("",JLabel.RIGHT);JButton jb=new JButton("Run Modeller");jp.add(target_label);jp.add(target);jp.add(temp_label);jp.add(template);jp.add(chain_label);jp.add(chain);jp.add(cc);jp.add(jb);mainjp.add(jp,BorderLayout.NORTH);add(mainjp);}}class Modelerhelp extends JPanel{public Modelerhelp() {JTextArea helpbar=new JTextArea("",500,100);String msg="\tGModeller is a graphical based suite for modeller.Before running this GMODELLER ,you shoul have already installed modeller .   Set the following PATH varables for running this GModeller.\n   (if your modeller version is 9v8.replace your version of modeller  \n   Preparing input files: \n";helpbar.setText(msg);helpbar.setLineWrap(true);       // wrap linehelpbar.setWrapStyleWord(true);  // wrap line at word boundary//helpbar.setBackground(new Color(204, 238, 241)); // lightadd(helpbar);}}class Molp extends JPanel {public Molp() {JCheckBox cb1 = new JCheckBox("Red");add(cb1);JCheckBox cb2 = new JCheckBox("Green");add(cb2);JCheckBox cb3 = new JCheckBox("Blue");add(cb3);}}class Moleculetab extends JPanel  implements MouseListener{ static String prevres=null;JPanel p1,p2,p3;JTable  jtpdb,table;public Moleculetab() {p1=new JPanel();p2=new JPanel();p3=new JPanel();}public  Moleculetab(Object[][] data,String s) {String col[]={"Select","Generated DIMERS","Energy"};//JTable table = new JTable(data,col);final Class[] columnClass = new Class[]		{            Boolean.class, String.class, Integer.class         };         //create table model with data        DefaultTableModel model = new DefaultTableModel(data, col) 		{              @Override            public Class<?> getColumnClass(int columnIndex)            {                return columnClass[columnIndex];            }        };          table = new JTable(model);Font font = new Font("Courier", Font.BOLD,12);table.setFont(font);table.setBackground(Color.orange);table.setPreferredScrollableViewportSize(new Dimension(650,300));TableColumn column = table.getColumnModel().getColumn(0);column.setMaxWidth(100);TableColumn column1 = table.getColumnModel().getColumn(2);column1.setMaxWidth(120);int height = table.getRowHeight();table.setRowHeight(height+8);table.addMouseListener(this);JScrollPane jsp = new JScrollPane(table);add(jsp);}public Moleculetab(Object[][] data) {String col[]={"Select","CIF FIle Co-ordinate Information","ATOM"};//JTable table = new JTable(data,col);final Class[] columnClass = new Class[]		{            Boolean.class, String.class, Integer.class         };         //create table model with data        DefaultTableModel model = new DefaultTableModel(data, col) 		{              @Override            public Class<?> getColumnClass(int columnIndex)            {                return columnClass[columnIndex];            }        };          table = new JTable(model);Font font = new Font("Courier", Font.BOLD,12);table.setFont(font);table.setBackground(Color.orange);table.setPreferredScrollableViewportSize(new Dimension(650,300));TableColumn column = table.getColumnModel().getColumn(0);column.setMaxWidth(100);TableColumn column1 = table.getColumnModel().getColumn(2);column1.setMaxWidth(120);int height = table.getRowHeight();table.setRowHeight(height+8);table.addMouseListener(this);JScrollPane jsp = new JScrollPane(table);add(jsp);}public void mouseExited(MouseEvent me){}public void mouseEntered(MouseEvent me){}public void mouseReleased(MouseEvent me){}public void mousePressed(MouseEvent me){}public void mouseClicked(MouseEvent me){int row=table.rowAtPoint(me.getPoint());int col=table.columnAtPoint(me.getPoint());col=col+2;String ress=table.getValueAt(row,col).toString();String msg="select "+ress+" ;backbone 0.9; font label 30 serif bold ;label "+ ress;Molvis.jmolPanel.viewer.evalString(msg);MyMenuHandler.clickcount++;System.out.println("count=0"+msg+"   "+MyMenuHandler.clickcount);prevres=ress;//JOptionPane.showMessageDialog(null,"aaa"+msg);}       }//remove residueclass Moleculetab1 extends JPanel  implements MouseListener{JPanel p1,p2,p3;JTable  jtpdb,table;public Moleculetab1() {p1=new JPanel();p2=new JPanel();p3=new JPanel();}public Moleculetab1(Object[][] data) {String col11[]={"ATOM1","ATOM2","Type of Interaction","rd-ra","rd+ra"};//JTable table = new JTable(data,col);final Class[] columnClass = new Class[]		{//String.class,String.class,String.class,String.class,String.class;         };         //create table model with data        DefaultTableModel model = new DefaultTableModel(data, col11) 		{              @Override            public Class<?> getColumnClass(int columnIndex)            {                return columnClass[columnIndex];            }        };          table = new JTable(model);Font font = new Font("Courier", Font.BOLD,12);table.setFont(font);table.setPreferredScrollableViewportSize(new Dimension(650,300));TableColumn column = table.getColumnModel().getColumn(0);column.setMaxWidth(100);TableColumn column1 = table.getColumnModel().getColumn(2);column1.setMaxWidth(120);int height = table.getRowHeight();table.setRowHeight(height+8);table.addMouseListener(this);JScrollPane jsp = new JScrollPane(table);add(jsp);}public void mouseExited(MouseEvent me){}public void mouseEntered(MouseEvent me){}public void mouseReleased(MouseEvent me){}public void mousePressed(MouseEvent me){}public void mouseClicked(MouseEvent me){int row=table.rowAtPoint(me.getPoint());int col=table.columnAtPoint(me.getPoint());col=col+1;String res=table.getValueAt(row,col).toString();//String msg="select " + res + " ; backbone 0.9; color  labels %m;";String msg="select atomno="+res+"color white ";Molvis.jmolPanel.viewer.evalString(msg);//JOptionPane.showMessageDialog(null,"aaa"+msg);}       }class downPane extends JPanel{downPane(){	String dt[][]=hbond(1); //JTextArea area=new JTextArea();  //area.setBackground(Color.orange); //add(area);String column1[]={"A1","A2","interaction","rd-ra","rd+ra"};      JTable jt=new JTable(dt,column1);  jt.setBounds(30,40,200,300);              JScrollPane sp=new JScrollPane(jt);	add(jt);}public static String[][]  hbond(int no){//	String[][] myArray;String[][] myArray= new String[2][5];	String line="";	  try	  {	  	   double rd=0;  double ra=0;  List<String[]> lines = new ArrayList<>();  Scanner sc=new Scanner(System.in);  //System.out.println("Give the file"+u+" path properly!");   //String s=sc.nextLine();	  File f = new File("aa.cif");   Scanner inFile1= new Scanner(f);	  while(inFile1.hasNextLine()) {    String linew = inFile1.nextLine().trim();    String[] splitted = linew.split(" ");    lines.add(splitted);}double dis1=0;double dis2=0;//convert List<String[]> to String[][]String[][] result = new String[lines.size()][];double rf=0,rg=0;String ato="";		  String atoo="";for(int i = 0; i<result.length; i++) {    result[i] = lines.get(i);}Map<String, Double> map = new HashMap<String, Double>();map.put("H",1.2);map.put("C",1.70);map.put("O",1.52);map.put("N",1.55);map.put("He",1.4);map.put("F",1.47);map.put("Si",2.10);map.put("P",1.80);map.put("S",1.80);map.put("Cl",1.75);map.put("As",1.85);map.put("Se",1.90);map.put("Br",1.85);map.put("Te",2.06);map.put("I",1.98);/*for(int g=0;g<result.length;g++){	for(int h=0;h<=3;h++)	{System.out.println(result[g][h]+"\n");	}}*/int countrows=0;for(int x=0;x<result.length;x+=3)	{	countrows++;}int rw1=0,cl1=0;for(int x=0;x<result.length;x+=3)	{		double xsq1=(Double.parseDouble(result[x+1][1])-Double.parseDouble(result[x][1]))*(Double.parseDouble(result[x+1][1])-Double.parseDouble(result[x][1]));double ysq1=(Double.parseDouble(result[x+1][2])-Double.parseDouble(result[x][2]))*(Double.parseDouble(result[x+1][2])-Double.parseDouble(result[x][2]));double zsq1=(Double.parseDouble(result[x+1][3])-Double.parseDouble(result[x][3]))*(Double.parseDouble(result[x+1][3])-Double.parseDouble(result[x][3]));dis1=Math.sqrt(xsq1+ysq1+zsq1)*0.5292;double rr=map.get(result[x][0]);ato=result[x][0];ra=rr-dis1;//acceptor calcdouble xsq2=(Double.parseDouble(result[x+2][1])-Double.parseDouble(result[x+1][1]))*(Double.parseDouble(result[x+2][1])-Double.parseDouble(result[x+1][1]));double ysq2=(Double.parseDouble(result[x+2][2])-Double.parseDouble(result[x+1][2]))*(Double.parseDouble(result[x+2][2])-Double.parseDouble(result[x+1][2]));double zsq2=(Double.parseDouble(result[x+2][3])-Double.parseDouble(result[x+1][3]))*(Double.parseDouble(result[x+2][3])-Double.parseDouble(result[x+1][3]));dis2=Math.sqrt(xsq2+ysq2+zsq2)*0.5292;double ro=map.get(result[x+2][0]);atoo=result[x+2][0];rd=ro-dis2;//echo "Distance2: $dis2<br>";rf=rd+ra;rg=rd-ra;if((rd+ra)>0 && (rd-ra)>0){		line=line+"ATOM1-"+ato+"\t" +"ATOM2-"+atoo+"\t"+"Hydrogen\t"+"rd-ra=>"+ rg +"\t"+"rd+ra=>"+ rf +"\n";		myArray[rw1][0]=ato;	myArray[rw1][1]=atoo;    myArray[rw1][2]="hydrogen";    myArray[rw1][3]=""+rg;	myArray[rw1][4]=""+rf;		rw1++;		}else{	line="ATOM1-"+ato+"\t" +"ATOM2-"+atoo+"\t"+"VanderWaals\t"+"rd-ra=>"+ rg +"\t"+"rd+ra=>"+ rf +"\n";	myArray[rw1][0]=ato;	myArray[rw1][1]=atoo;myArray[rw1][2]="hydrogen";myArray[rw1][3]=""+rg;	myArray[rw1][4]=""+rf;	rw1++;} //else } //for   } //try   catch(FileNotFoundException e)   {	      }return myArray;} //hbond method } //classclass A{public void mlcread(String mlcfilename)	 {	int k=0; 	int count=0;int u=0;String str;	int r=0;	try{	FileReader fr=new FileReader(mlcfilename);	BufferedReader br=new BufferedReader(fr);	while((str=br.readLine())!=null)	{	 /*System.out.println(str);*/		count++;	}		fr.close();	}catch(Exception e) {	System.out.println("NO FILE");  } int count2=0;	try	{		FileReader fr=new FileReader(mlcfilename);        BufferedReader br=new BufferedReader(fr);        String str3;		while((str3=br.readLine())!=null)		{		count2++;		}	}catch(Exception e){	}String pdb2[]=new String[count2];try{	FileReader fr=new FileReader(mlcfilename);    BufferedReader br=new BufferedReader(fr);	String str3;	int i=0;	while((str3=br.readLine())!=null)	{		pdb2[i]=str3;		//System.out.println(pdb2[i]);		i++;	}}catch(Exception e){	} String pdb[]=new String[count]; String x1[]=new String[count];  String y1[]=new String[count];   String z1[]=new String[count]; double x[]=new double[count]; double y[]=new double[count]; double z[]=new double[count];double x2[]=new double[count];double y2[]=new double[count];double z2[]=new double[count];  try {	FileReader fr1=new FileReader(mlcfilename);	BufferedReader br1=new BufferedReader(fr1);	 while((str=br1.readLine())!=null)	{	pdb[u]=str;	u++;	}	 for(int j=1;j<count;j++){	 x[j]=Double.parseDouble(pdb[j].substring(7,12));	 y[j]=Double.parseDouble(pdb[j].substring(27,32));	 z[j]=Double.parseDouble(pdb[j].substring(47,52));	 x2[j]=Double.parseDouble(pdb[j].substring(52,60));	 y2[j]=Double.parseDouble(pdb[j].substring(60,68));	 z2[j]=Double.parseDouble(pdb[j].substring(68,72));	 k++;	   if(pdb[j].substring(7,12)=="     " &&  (pdb[j].substring(27,32))=="     " && (pdb[j].substring(47,52))=="     ")	   {		   break;	   }	   else	   {		   continue;	   }}fr1.close();}catch(Exception e) { } for(int h=1;h<=k;h++){	if(x[h]<0)	{		x1[h]="-x";	}	else{		x1[h]="x";	}	if(y[h]<0)	{		y1[h]="-y";	}	else{		y1[h]="y";	}	if(z[h]<0)	{		z1[h]="-z";	}	else{		z1[h]="z";	}	}try{      FileWriter fw=new FileWriter("test.cif");  fw.write("         'P 21/c symmetry operations");fw.write("\r\n");  for(int f=1;f<=k;f++){if(x2[f]<0){	   if(x1[f]=="x")	     {	       fw.write("          "+" "+x1[f]+x2[f]+"  ");	     }	   else	     {		    fw.write("          "+x1[f]+x2[f]+"  ");	     }}    else if(x2[f]==0.0){         if(x1[f]=="x")	      {		    fw.write("          "+" "+x1[f]+"      ");	      }        else	      {			  fw.write("          "+x1[f]+"      ");}	          }else{	if(x1[f]=="x")	{	fw.write("          "+" "+x1[f]+"+"+x2[f]+"  ");	}	else	{		fw.write("          "+x1[f]+"+"+x2[f]+"  ");	}}if(y2[f]<0){	if(y1[f]=="y")	{	fw.write(" "+y1[f]+y2[f]+"  ");	}	else{fw.write(y1[f]+y2[f]+"  ");}	}    else if(y2[f]==0.0){	if(y1[f]=="y")	{	fw.write(" "+y1[f]+"      ");	}	else{fw.write(y1[f]+"      ");}}else{	if(y1[f]=="y")	{	fw.write(" "+y1[f]+"+"+y2[f]+"  ");    }	else{fw.write(y1[f]+"+"+y2[f]+"  ");}}if(z2[f]<0){   if(z1[f]=="z")	{	fw.write(" "+z1[f]+z2[f]+"  ");	}	else{fw.write(z1[f]+z2[f]+"  ");}}    else if(z2[f]==0.0){if(z1[f]=="z")	{	fw.write(" "+z1[f]+"      ");	}	else{fw.write(z1[f]+"      ");}	}else{	if(z1[f]=="z")	{	fw.write(" "+z1[f]+"+"+z2[f]+"  ");	}	else{fw.write(z1[f]+"+"+z2[f]+"  ");}}		   fw.write("\r\n");}		             		  		  		  int flag=k+2;System.out.println(flag);int elength=pdb2.length-flag;String energy[]=new String[elength-1];double s1[]=new double[elength-1];double s2[]=new double[elength-1];double s3[]=new double[elength-1];double s4[]=new double[elength-1];double s5[]=new double[elength-1];String c1[]=new String[elength-1];String c2[]=new String[elength-1];String c3[]=new String[elength-1];String c4[]=new String[elength-1];String c5[]=new String[elength-1];int j=0;String a1[]=new String[elength-1];String a2[]=new String[elength-1];for(int i=flag+1;i<pdb2.length;i++){	energy[j]=pdb2[i];	j++;}String output="";fw.write("********************ENergy CALCULATIONS*****************");fw.write("\r\n");fw.write("\r\n");for(int i=0;i<energy.length;i++){	s1[i]=(1/4.184)*(Double.parseDouble(energy[i].substring(20,25).replaceAll(" ","")));	s2[i]=(1/4.184)*(Double.parseDouble(energy[i].substring(27,32).replaceAll(" ","")));	s3[i]=(1/4.184)*(Double.parseDouble(energy[i].substring(34,39).replaceAll(" ","")));	s4[i]=(1/4.184)*(Double.parseDouble(energy[i].substring(41,46).replaceAll(" ","")));	s5[i]=(1/4.184)*(Double.parseDouble(energy[i].substring(48,53).replaceAll(" ","")));		s1[i]=Math.round(s1[i]*10)/10.00;	s2[i]=Math.round(s2[i]*10)/10.00;	s3[i]=Math.round(s3[i]*10)/10.00;	s4[i]=Math.round(s4[i]*10)/10.00;	s5[i]=Math.round(s5[i]*10)/10.00;	a1[i]=energy[i].substring(4,18);	a2[i]=energy[i].substring(57,69);		c1[i]=""+s1[i];	c2[i]=""+s2[i];	c3[i]=""+s3[i];	c4[i]=""+s4[i];	c5[i]=""+s5[i];	output="\t"+a1[i];	if((c1[i].length()) == 6)	{		output=output+" "+c1[i];	}	else if((c1[i].length()) == 5)	{		output= output+"  "+c1[i];	}	else if((c1[i].length()) == 4)	{		output=output+"   "+c1[i];	}	else if((c1[i].length()) == 3)	{		output=output+"    "+c1[i];	}	else if((c1[i].length()) == 2)	{		output=output+"     "+c1[i];	}	else if((c1[i].length()) == 1)	{		output=output+"      "+c1[i];	}	if((c2[i].length()) == 6)	{		output=output+" "+c2[i];	}	else if((c2[i].length()) == 5)	{		output= output+"  "+c2[i];	}	else if((c2[i].length()) == 4)	{		output=output+"   "+c2[i];	}	else if((c2[i].length()) == 3)	{		output=output+"    "+c2[i];	}	else if((c2[i].length()) == 2)	{		output=output+"     "+c2[i];	}	else if((c2[i].length()) == 1)	{		output=output+"      "+c2[i];	}	if((c3[i].length()) == 6)	{		output=output+" "+c3[i];	}	else if((c3[i].length()) == 5)	{		output= output+"  "+c3[i];	}	else if((c3[i].length()) == 4)	{		output=output+"   "+c3[i];	}	else if((c3[i].length()) == 3)	{		output=output+"    "+c3[i];	}	else if((c3[i].length()) == 2)	{		output=output+"     "+c3[i];	}	else if((c3[i].length()) == 1)	{		output=output+"      "+c3[i];	}	if((c4[i].length()) == 6)	{		output=output+" "+c4[i];	}	else if((c4[i].length()) == 5)	{		output= output+"  "+c4[i];	}	else if((c4[i].length()) == 4)	{		output=output+"   "+c4[i];	}	else if((c4[i].length()) == 3)	{		output=output+"    "+c4[i];	}	else if((c4[i].length()) == 2)	{		output=output+"     "+c4[i];	}	else if((c4[i].length()) == 1)	{		output=output+"      "+c4[i];	}	if((c5[i].length()) == 6)	{		output=output+" "+c5[i];	}	else if((c5[i].length()) == 5)	{		output= output+"  "+c5[i];	}	else if((c5[i].length()) == 4)	{		output=output+"   "+c5[i];	}	else if((c5[i].length()) == 3)	{		output=output+"    "+c5[i];	}	else if((c5[i].length()) == 2)	{		output=output+"     "+c5[i];	}	else if((c5[i].length()) == 1)	{		output=output+"      "+c5[i];	}	output=output+"\t"+a2[i]+"\n";    fw.write(output);	output="";}fw.close(); }catch(Exception e)		  {			  System.out.println(e);		  }              System.out.println("Success...");}}class B{	public double[]  ciffileread(String filenn,String ciffile)	throws ScriptException	{		System.out.println(filenn+""+ciffile); 		ScriptEngineManager mgr = new ScriptEngineManager();		ScriptEngine engine = mgr.getEngineByName("JavaScript");		int N=1000;		int count=0;int i=0;String str; String str4; int k[]=new int[N]; int yu=1,k1=0;		int r=0;		try		{			FileReader fr=new FileReader(filenn);			BufferedReader br=new BufferedReader(fr);			while((str=br.readLine())!=null)			{				count++;			}			fr.close();		}		catch(Exception e)		{			System.out.println("NO FILE"); 		}		System.out.println(N); 		String pdb[]=new String[N];		double x[]=new double[N]; 		try		{			FileReader fr1=new FileReader(filenn);			BufferedReader br1=new BufferedReader(fr1);			while((str=br1.readLine())!=null)			{				pdb[i]=str;				i++;			}			for(int j=0;j<count;j++)			{								k1++;				if(pdb[j].substring(7,12)=="     " &&  (pdb[j].substring(27,32))=="     " && (pdb[j].substring(47,52))=="     ")				{					break;				}				else				{					continue;				}			}			fr1.close();		}  				catch(Exception e)		{			System.out.println("asase");		}		System.out.println();		System.out.println(count);				for(int f=k1;f<count;f++)		{			System.out.println(pdb[f]);			x[yu]=Double.parseDouble(pdb[f].substring(45,50));				yu++;		}		System.out.println(yu);		int min;		for(int z=0;z<yu;z++)			k[z]=z;		for(int z=0;z<yu;z++)		{			min=z;			for(int f=z+1;f<yu;f++)			{				if(x[k[f]]<x[k[min]])				{					min=f;				}			}			int t=k[z];			k[z]=k[min];			k[min]=t;		}		System.out.println("The sorted values are:");		for(int z=0;z<k.length;z++)		{						System.out.println(k[z]);		}		double ret[]=new double[yu];		for(int z=0;z<yu;z++)		{			ret[z]=x[k[z]];		}		System.out.println();		int y=0; int counter=0;  i=0; String str2;		try		{			FileReader fr=new FileReader(ciffile);			BufferedReader br=new BufferedReader(fr);			while((str2=br.readLine())!=null)			{					counter++;			}				fr.close();		}			catch(Exception e)		{			System.out.println("NO FILE"); 		}		String cif[]=new String[N];		try		{			FileReader fr4=new FileReader(ciffile);			BufferedReader br4=new BufferedReader(fr4);			while((str4=br4.readLine())!=null)			{				cif[y]=str4;				y++;			}		}		catch(Exception e)		{			System.out.println(e);		}		String pdb2[]=new String[N];		String x2[]=new String[N];		String y2[]=new String[N];		String z2[]=new String[N];		String w1[]=new String[N];		String w2[]=new String[N];        				int u=0;		try		{			FileReader fr2=new FileReader(ciffile);			BufferedReader br2=new BufferedReader(fr2);			while((str2=br2.readLine())!=null)			{				pdb2[i]=str2;				i++;			}			for(int j=44;j<count;j++)			{				String[] words=pdb2[j].split("\\s+");//splits the string based on whitespace   				for(int f=0;f<1;f++)				{   					w1[u]=words[f+0];					w2[u]=words[f+1];					x2[u]=words[f+2];					y2[u]=words[f+3];					z2[u]=words[f+4];				}				u++;			}			fr2.close();		}   		catch(Exception e)		{			System.out.println(e+"hi");		}		try		{			System.out.println(yu);			for(int z=0;z<yu;z++)			{				FileWriter fw=new FileWriter("testout"+(k[z]+1)+".cif");				for(int j=0;j<y;j++)				{					fw.write(cif[j]);					fw.write("\n");				}								String x1=pdb[k[z]+1].substring(10,16);				String y1=pdb[k[z]+1].substring(17,25);				String z1=pdb[k[z]+1].substring(26,33);												for(int j=0;j<u;j++)				{ 					String sx=x1.replace("x",("("+x2[j]+")"));					String sy=y1.replace("y",("("+y2[j]+")"));					String sz=z1.replace("z",("("+z2[j]+")"));					Object  result1=engine.eval(sx);					Object result2=engine.eval(sy);					Object result3=engine.eval(sz);					fw.write(w1[j]+"  "+w2[j]+"  "+result1+"  "+result2+"  "+ result3);					fw.write("\r\n");				}				fw.close();    			}		}		catch(Exception e)		{			System.out.println(e);		}    		System.out.println("Success...");		return ret;		}}class Density{	public void densityread(String filename)		{		int count=0;		try		{			FileReader fr=new FileReader("styq_3.cif");			BufferedReader br=new BufferedReader(fr);			String str;			while((str=br.readLine())!=null)			{				count++;			}		    //System.out.println(count);			fr.close();			br.close();		}		catch(Exception e)		{					}		String cif[]=new String[count];		try		{		    int i=0;			FileReader fr=new FileReader("styq_3.cif");			BufferedReader br=new BufferedReader(fr);			String str;			while((str=br.readLine())!=null)			{				cif[i]=str;				//System.out.println(cif[i]);				i++;			}			fr.close();			br.close();		}		catch(Exception e)		{					}		int count1=0;;		String s;		int j=0;		int start=0;		for(int i=0;i<cif.length;i++)		{			if(cif[i].equals("_atom_site_fract_z"))			{			   start=i+1;			}		}		int c=0,h=0,o=0,n=0;		for(int i=start;i<cif.length-1;i++)		{			j++;			String atom=cif[i].substring(0,1);			if(atom.equals("C"))			{				c++;			}		    else if(atom.equals("H"))			{				h++;			}		    else if(atom.equals("O"))			{				o++;			}		    else if(atom.equals("N"))			{				n++;			}		}		/*System.out.println("Line count: "+j);		System.out.println("C count: "+c);		System.out.println("H count: "+h);		System.out.println("O count: "+o);		System.out.println("N count: "+n);*/		double vol=0;		for(int i=0;i<cif.length;i++)		{			if(cif[i].equals("_cell_volume 1664.44"))			{				vol=Double.parseDouble(cif[i].substring(13,20).replaceAll(" ",""));				//System.out.println(vol);			}		}		double mc=0;		double mn=0;		double mh=0;		double mo=0;		mc=c*12.01;		mn=n*14.00;		mo=o*16.00;		mh=h*1.01;		/*System.out.println("C molar mass: "+mc);		System.out.println("H molar mass: "+mh);		System.out.println("O molar mass: "+mo);		System.out.println("N molar mass: "+mn);*/		double total_mass=mc+mo+mn+mh;		//System.out.println("Total molar mass: "+total_mass);		double density=(j*total_mass)/(vol*6.023*Math.pow(10,23));		System.out.println("Density:"+density);	}		}